(this["webpackJsonpe-commerce"]=this["webpackJsonpe-commerce"]||[]).push([[0],{214:function(e,t,a){e.exports=a(411)},219:function(e,t,a){},317:function(e,t,a){},411:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(5),i=a.n(r),l=(a(219),a(152),a(61)),c=(a(221),a(206)),s=(a(122),a(77)),u=(a(153),a(43)),d=(a(154),a(69)),p=(a(50),a(10)),m=a(20),h=a(21),g=a(23),f=a(22),y=a(24),b=(a(124),a(59)),E=(a(70),a(25)),v=a(60),k=(a(80),a(37)),O=(a(144),a(41)),j=a(57),C="http://60.205.186.115",S=E.a.Content,w=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(g.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(o)))).state={shops:[],spinning:!0},a._isMounted=!1,a}return Object(y.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,fetch("".concat(C,"/public/get-shops"),{method:"post",headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(t){0===t.code&&e._isMounted?e.setState({shops:t.obj,spinning:!1}):p.a.error("\u52a0\u8f7d\u6570\u636e\u51fa\u9519")}))}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"render",value:function(){return o.a.createElement(E.a,{style:{padding:"24px 0",background:"#fff",marginTop:"46px"}},o.a.createElement(S,{style:{padding:"0 24px",minHeight:280}},o.a.createElement(k.a,{spinning:this.state.spinning,tip:"Loading..."},o.a.createElement(O.a,{itemLayout:"vertical",size:"large",pagination:{onChange:function(){},pageSize:5},dataSource:this.state.shops,renderItem:function(e){return o.a.createElement(O.a.Item,{key:e.id,actions:[],extra:o.a.createElement("img",{width:236,height:132,alt:"logo",src:e.logo})},o.a.createElement(O.a.Item.Meta,{avatar:o.a.createElement(s.a,{src:e.owner.avatar,className:"avatar"}),title:o.a.createElement(j.a,{to:"/shop/".concat(e.owner.phone)},e.name),description:"".concat(e.owner.desc," \u624b\u673a\uff1a").concat(e.owner.phone)}),e.desc.substr(0,70))}}))))}}]),t}(n.Component),I=function(e){function t(){return Object(m.a)(this,t),Object(g.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=document.createElement("script");e.src="//qzonestyle.gtimg.cn/qzone/hybrid/app/404/search_children.js",e.async=!0,e.charset="utf-8",e.setAttribute("homePageUrl","/"),e.setAttribute("homePageName","\u8fd4\u56de\u4e3b\u9875"),document.getElementById("404").appendChild(e)}},{key:"render",value:function(){return o.a.createElement("div",{title:"404",id:"404",style:{width:"100%",height:"100vh",border:"none"}})}}]),t}(o.a.Component),x=(a(51),a(16)),M=(a(299),a(202)),L=(a(91),a(38)),N=(a(100),a(3)),T=(a(173),a(115)),D=a(114),U=a(200),P=a.n(U),G=a(34),_=Object(G.a)();function A(){localStorage.removeItem("token"),p.a.info("\u767b\u5f55\u4fe1\u606f\u5931\u6548\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55"),setTimeout((function(){_.push("/login")}),2e3)}function J(e,t){var a=localStorage.getItem("token")||"";return t=Object.assign(t,{headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"}}),fetch("".concat(C).concat(e),t).then((function(e){return e.json()})).then((function(e){return-128===e.code&&(localStorage.removeItem("token"),A()),e})).catch((function(e){return console.log(e),{code:-127,msg:"error",obj:null}}))}function z(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function q(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?z(Object(a),!0).forEach((function(t){Object(D.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):z(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var W=E.a.Content,B=b.a.Title,H=b.a.Text,V=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(g.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(o)))).input={nickname:"",password:"",phone:"",seller:!1},a.state={loading:!1},a.handleInputChange=function(e){var t=e.target,n="checkbox"===t.type?t.checked:t.value,o=t.name;a.input[o]=n},a.login=function(){a.input.nickname.length>8?p.a.error("\u6635\u79f0\u957f\u5ea6\u4e0d\u5408\u6cd5"):a.input.password.length<3?p.a.error("\u5bc6\u7801\u81f3\u5c11\u4e3a3\u4f4d"):/^1[3456789]\d{9}$/.test(a.input.phone)?(a.setState({loading:!0}),fetch("".concat(C,"/login"),{method:"post",body:JSON.stringify(q({},a.input,{nickname:0===a.input.nickname.length?"\u672a\u547d\u540d":a.input.nickname,password:P()(a.input.password)})),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){0===e.code?(p.a.success(e.msg),localStorage.setItem("token",e.token),setTimeout((function(){_.push("/")}),2e3)):(p.a.error(e.msg),a.setState({loading:!1}))}))):p.a.error("\u624b\u673a\u53f7\u683c\u5f0f\u9519\u8bef")},a}return Object(y.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){localStorage.getItem("token")&&_.push("/")}},{key:"render",value:function(){var e=this;return o.a.createElement(E.a,{style:{padding:"24px 0",background:"#fff",marginTop:"46px"}},o.a.createElement(W,{style:{padding:"0 24px",minHeight:280}},o.a.createElement(B,{level:3},"\u767b\u5f55/\u6ce8\u518c"),o.a.createElement(T.a,null),o.a.createElement(L.a,{name:"nickname",placeholder:"\u7528\u6237\u540d\uff08\u767b\u5f55\u65e0\u9700\u8f93\u5165\uff09",prefix:o.a.createElement(N.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),onChange:this.handleInputChange}),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement(L.a.Password,{placeholder:"\u5bc6\u7801",name:"password",prefix:o.a.createElement(N.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),onChange:this.handleInputChange}),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement(L.a,{name:"phone",placeholder:"\u624b\u673a\u53f7",prefix:o.a.createElement(N.a,{type:"phone",style:{color:"rgba(0,0,0,.25)"}}),onChange:this.handleInputChange}),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement(H,null,"\u6ce8\u518c\u4e3a\uff1a"),o.a.createElement(M.a,{checkedChildren:"\u5546\u5bb6\u7528\u6237",unCheckedChildren:"\u666e\u901a\u7528\u6237",onChange:function(t){return e.input.seller=t}}),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement(x.a,{loading:this.state.loading,type:"primary",block:!0,onClick:this.login},"\u4e0b\u4e00\u6b65"),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement(H,{type:"",style:{fontSize:"0.5em",display:"block",textAlign:"center"}},"\u672a\u6ce8\u518c\u7528\u6237\u5c06\u81ea\u52a8\u6ce8\u518c\uff0c\u5df2\u6ce8\u518c\u7528\u6237\u5c06\u76f4\u63a5\u767b\u5f55")))}}]),t}(n.Component),F=(a(175),a(90)),K=(a(313),a(211)),R=(a(315),a(212)),$=E.a.Content,Q=b.a.Title,X=b.a.Text,Y=function(e){function t(){return Object(m.a)(this,t),Object(g.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement(O.a,{itemLayout:"vertical",size:"middle",dataSource:this.props.dataSource,renderItem:function(t){return o.a.createElement(O.a.Item,{key:t.id,extra:o.a.createElement("div",{className:"add-btn"},o.a.createElement(x.a,{type:"primary",onClick:function(){return e.props.onClick(t)}},e.props.buttonText,"\uff1a",t.price,"\u5143"))},o.a.createElement(l.a,{type:"flex",gutter:16},o.a.createElement(u.a,null,o.a.createElement("img",{width:118,height:66,alt:"\u5546\u54c1\u56fe\u7247",src:t.img})),o.a.createElement(u.a,null,o.a.createElement(O.a.Item.Meta,{title:o.a.createElement(X,null,t.name),description:t.desc.substr(0,e.props.descLength||70)+"..."}))))}})}}]),t}(n.Component),Z=Object(v.f)(function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(g.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(o)))).state={showCartModal:!1,cartList:[],submitLoading:!1,spinning:!0,shopData:{name:"...",desc:"......",logo:"https://ycimg.woofeng.cn/20180128/20180128231509_26298.jpg"},qrcode:"",paying:!1},a.toggleCartModal=function(){a.setState({showCartModal:!a.state.showCartModal})},a}return Object(y.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=JSON.parse(localStorage.getItem("carts"));t&&t[this.props.match.params.id]&&this.setState({cartList:t[this.props.match.params.id]}),fetch("".concat(C,"/public/get-shop-data"),{method:"post",body:JSON.stringify({phone:this.props.match.params.id}),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(t){e.setState({spinning:!1}),0===t.code?e.setState({shopData:t.obj}):p.a.error("\u83b7\u53d6\u6570\u636e\u51fa\u9519")}))}},{key:"componentWillUnmount",value:function(){var e=JSON.parse(localStorage.getItem("carts")),t={};t[this.props.match.params.id]=this.state.cartList,localStorage.setItem("carts",JSON.stringify(Object.assign(e||{},t)))}},{key:"render",value:function(){var e=this,t=this.state.shopData;return o.a.createElement(E.a,{style:{padding:"24px 0",background:"#fff",marginTop:"46px"}},o.a.createElement($,{style:{padding:"0 24px",minHeight:280}},o.a.createElement(k.a,{tip:"Loading...",spinning:this.state.spinning},o.a.createElement(l.a,null,o.a.createElement(u.a,{span:10},o.a.createElement("div",{className:"shop-logo-container"},o.a.createElement("img",{src:t.logo,alt:"logo",className:"shop-logo"}))),o.a.createElement(u.a,{span:14,style:{padding:"0 16px"}},o.a.createElement(Q,{level:2},t.name),o.a.createElement(X,null,t.desc))),o.a.createElement(T.a,null),o.a.createElement(l.a,null,o.a.createElement(u.a,null,o.a.createElement(Y,{dataSource:t.goods,buttonText:"\u52a0\u5165\u8d2d\u7269\u8f66",onClick:function(t){var a=Object.assign({},t);a.oriKey=a.key,e.state.cartList.push(Object.assign(a,{key:"".concat(Date.now(),"-").concat(a.key)})),e.setState({cartList:e.state.cartList})}}))),o.a.createElement("br",null))),o.a.createElement(K.a,{offsetBottom:20},o.a.createElement(l.a,{type:"flex",justify:"end"},o.a.createElement(u.a,null,o.a.createElement(R.a,{count:this.state.cartList.length,offset:[-6,4]},o.a.createElement(N.a,{type:"shopping-cart",className:"shopping-cart",onClick:this.toggleCartModal}))),o.a.createElement(u.a,{span:1}))),o.a.createElement(F.a,{title:"\u8d2d\u7269\u8f66",visible:this.state.showCartModal,onOk:this.handleOk,onCancel:this.toggleCartModal,width:600,footer:[o.a.createElement(x.a,{key:"back",onClick:this.toggleCartModal},"\u8fd4\u56de"),o.a.createElement(x.a,{key:"submit",type:"primary",loading:this.state.submitLoading||this.state.paying,onClick:function(){var t=e.state.cartList;if(t.length<1)p.a.error("\u8bf7\u5148\u9009\u62e9\u8d2d\u4e70\u7684\u5546\u54c1");else{e.setState({submitLoading:!0});var a=t.map((function(e){var t=Object.assign({},e);return t.key=e.oriKey,t}));J("/submit-order",{method:"post",body:JSON.stringify({phone:e.props.match.params.id,goods:a})}).then((function(t){if(0===t.code){p.a.info("\u8bf7\u7528\u624b\u673a\u626b\u7801\u652f\u4ed8"),e.setState({submitLoading:!1,qrcode:t.obj.qrcode,paying:!0});var a=!1,n=setInterval((function(){a||(a=!0,J("/public/query-order",{method:"post",body:JSON.stringify({orderId:t.obj.orderId})}).then((function(t){0===t.code?(clearInterval(n),p.a.success("\u652f\u4ed8\u6210\u529f"),e.setState({cartList:{}}),_.push("/success")):a=!1})))}),1e3)}else p.a.error("\u4e0b\u5355\u5931\u8d25\uff01"),e.setState({submitLoading:!1})}))}}},this.state.paying?"\u652f\u4ed8\u4e2d...":"\u63d0\u4ea4\u8ba2\u5355")]},o.a.createElement("div",{style:{maxHeight:"300px",overflow:"auto",padding:"0 10px"}},o.a.createElement(k.a,{tip:"\u8ba2\u5355\u751f\u6210\u4e2d...",spinning:this.state.submitLoading},this.state.paying?o.a.createElement("img",{src:this.state.qrcode,alt:"\u4e8c\u7ef4\u7801\u56fe\u7247",style:{display:"block",margin:"0 auto"}}):o.a.createElement(Y,{dataSource:this.state.cartList,buttonText:"\u79fb\u51fa\u8d2d\u7269\u8f66",descLength:15,onClick:function(t){var a=e.state.cartList;a.splice(a.indexOf(t),1),e.setState({cartList:a}),p.a.success("\u79fb\u51fa\u6210\u529f")}})))))}}]),t}(n.Component)),ee=(a(317),a(412),a(208)),te=(a(321),a(209)),ae=(a(413),a(207)),ne=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(g.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(o)))).state={loading:!1},a.handleChange=function(e){"uploading"!==e.file.status?"error"===e.file.status?(p.a.error("\u4e0a\u4f20\u5931\u8d25"),a.setState({loading:!1})):"done"===e.file.status&&(a.setState({loading:!1}),a.props.onUpload(e.file.response)):a.setState({loading:!0})},a}return Object(y.a)(t,e),Object(h.a)(t,[{key:"beforeUpload",value:function(e){var t="image/jpeg"===e.type||"image/png"===e.type;t||p.a.error("\u53ea\u5141\u8bb8\u4e0a\u4f20 JPG/PNG \u6587\u4ef6");var a=e.size/1024/1024<2;return a||p.a.error("\u6587\u4ef6\u5927\u5c0f\u9700\u8981\u5c0f\u4e8e 2MB"),t&&a}},{key:"render",value:function(){var e=o.a.createElement("div",null,o.a.createElement(N.a,{type:this.state.loading?"loading":"plus"}),o.a.createElement("div",null,this.props.uploadText||"\u4e0a\u4f20")),t=this.props.imageUrl;return o.a.createElement(ae.a,{name:"image",listType:"picture-card",className:this.props.className,showUploadList:!1,action:"".concat(C,"/images/upload"),beforeUpload:this.beforeUpload,headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))},onChange:this.handleChange},t?o.a.createElement("img",{src:t,alt:"\u4e0a\u4f20\u56fe\u7247",style:this.props.style}):e)}}]),t}(n.Component);function oe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function re(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(a),!0).forEach((function(t){Object(D.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):oe(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var ie=E.a.Content,le=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(g.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(o)))).state={data:{},modifying:!1},a.input=a.props.data||{name:"",desc:"",logo:""},a.handleInputChange=function(e){var t=e.target,n="checkbox"===t.type?t.checked:t.value,o=t.name;a.input[o]=n},a._isMounted=!1,a.onModify=function(){a.setState({modifying:!0});var e=a.input,t=e.name,n=e.desc,o=e.logo,r=!0;(t.length>8||t.length<1)&&(r=!1,p.a.error("\u5e97\u94fa\u540d\u957f\u5ea6\u975e\u6cd5")),(0===n.length||n.length>100)&&(r=!1,p.a.error("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u63cf\u8ff0")),0===o.length&&(r=!1,p.a.error("\u8bf7\u4e0a\u4f20\u5e97\u94faLogo\uff0c\u5efa\u8bae\u5c3a\u5bf8\u4e3a4:3")),r?J("/modify-shop",{method:"post",body:JSON.stringify(a.input)}).then((function(e){a._isMounted&&(a.setState({modifying:!1}),0===e.code?(p.a.success(e.msg),a.props.onChange()):p.a.error(e.msg))})):a.setState({modifying:!1})},a}return Object(y.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this._isMounted=!0,this.setState({data:this.props.data})}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"render",value:function(){var e=this,t=this.state.data,a=t.name,n=t.desc,r=t.logo;return o.a.createElement(o.a.Fragment,null,o.a.createElement("br",null),o.a.createElement(L.a,{name:"name",placeholder:"\u5546\u5e97\u540d",defaultValue:a||"",onChange:this.handleInputChange}),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement(L.a,{name:"desc",placeholder:"\u5546\u5e97\u63cf\u8ff0",defaultValue:n,onChange:this.handleInputChange}),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement(ne,{className:"logo-uploader",uploadText:"\u4e0a\u4f20\u5e97\u94faLogo",name:"logo",imageUrl:r,onUpload:function(t){e.input.logo=t.obj,e.setState({data:re({},e.state.data,{logo:t.obj})})},style:{width:"292px",height:"218px"}}),o.a.createElement(x.a,{type:"primary",block:!0,loading:this.state.modifying,onClick:this.onModify},"\u4fdd\u5b58\u5e97\u94fa\u4fe1\u606f"))}}]),t}(n.Component),ce=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(g.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(o)))).handleInputChange=function(e){a.props.onChange(e)},a}return Object(y.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this,t=this.props.goods,a=t.name,n=t.desc,r=t.price,i=t.img;return o.a.createElement(F.a,this.props,o.a.createElement(L.a,{name:"name",placeholder:"\u5546\u54c1\u540d",onChange:this.handleInputChange,value:a}),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement(L.a,{name:"desc",placeholder:"\u5546\u54c1\u63cf\u8ff0",value:n,onChange:this.handleInputChange}),o.a.createElement("br",null),o.a.createElement("br",null),"\u4ef7\u683c\uff1a",o.a.createElement(te.a,{name:"price",onChange:function(t){return e.handleInputChange({target:{name:"price",value:t,type:"number"}})},value:r})," \u5143",o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement(ne,{className:"logo-uploader",uploadText:"\u4e0a\u4f20\u5546\u54c1\u56fe\u7247",name:"img",imageUrl:i||"",onUpload:function(t){e.handleInputChange({target:{type:"file",name:e.props.imgName||"img",value:t.obj}})},style:{width:"292px",height:"218px"}}))}}]),t}(n.Component);ce.defaultProps={goods:{}};var se=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(g.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(o))))._isMounted=!1,a.state={orders:[],goodsList:[],orderVisible:!1,loadingGoods:!1,loadingOrders:!0},a.handleCancel=function(){a.setState({orderVisible:!1})},a.handleOk=function(){},a}return Object(y.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,J("/query-all-order",{method:"POST"}).then((function(t){0===t.code?e._isMounted&&e.setState({loadingOrders:!1,orders:t.obj.map((function(e){return e.id}))}):p.a.error("\u67e5\u8be2\u8ba2\u5355\u9519\u8bef")}))}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"render",value:function(){var e=this;return o.a.createElement(k.a,{loading:"Loading...",spinning:this.state.loadingOrders},o.a.createElement("br",null),o.a.createElement(O.a,{size:"small",header:o.a.createElement("div",null,"\u8ba2\u5355\u53f7"),bordered:!0,dataSource:this.state.orders,renderItem:function(t){return o.a.createElement(O.a.Item,{onClick:function(){e.curItem=t,e.setState({orderVisible:!0,goodsList:[],loadingGoods:!0}),J("/query-order-goods",{method:"POST",body:JSON.stringify({orderId:t})}).then((function(a){e.setState({loadingGoods:!1}),e.curItem===t&&e.setState({goodsList:a.obj.map((function(e,t){return e.key=t+"-"+e.key,e}))})}))}},t)}}),o.a.createElement(F.a,{title:"\u8ba2\u5355\u5217\u8868",visible:this.state.orderVisible,onOk:this.handleOk,onCancel:this.handleCancel,width:600,footer:[o.a.createElement(x.a,{key:"confirm",type:"primary",onClick:this.handleCancel},"\u786e\u8ba4")]},o.a.createElement(k.a,{loading:"Loading...",spinning:this.state.loadingGoods},o.a.createElement(Y,{dataSource:this.state.goodsList,buttonText:"\u4ef7\u683c",descLength:15,onClick:function(e){}}))))}}]),t}(n.Component),ue=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(g.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(o)))).state={visible:!1,dataList:[],curGoods:{},isModify:!1,loading:!1},a.handleCancel=function(){a.setState({visible:!1})},a.handleOk=function(){},a.checkInput=function(){var e=a.goodsInput,t=e.name,n=e.desc,o=e.price,r=e.img,i=!0;return(0===t.length||t.length>100)&&(i=!1,p.a.error("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u5546\u54c1\u540d")),(0===n.length||n.length>100)&&(i=!1,p.a.error("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u5546\u54c1\u63cf\u8ff0")),(isNaN(o)||o<0)&&(i=!1,p.a.error("\u4ef7\u683c\u8bbe\u7f6e\u9519\u8bef")),0===r.length&&(i=!1,p.a.error("\u5546\u54c1\u56fe\u7247\u9519\u8bef")),i},a.addGoods=function(){if(a.checkInput()){var e=a.state.dataList;e.push(re({key:Date.now()},a.goodsInput)),a.setState({dataList:e}),a.handleCancel()}},a.modifyGoods=function(){if(a.checkInput()){var e=a.state.dataList;e=e.map((function(e){return e.key===a.goodsInput.key?a.goodsInput:e})),a.setState({dataList:e}),a.handleCancel()}},a.removeGoods=function(){var e=a.state.dataList;e=e.filter((function(e){return e.key!==a.goodsInput.key})),a.setState({dataList:e}),a.handleCancel()},a.handleInputChange=function(e){var t=e.target,n="checkbox"===t.type?t.checked:t.value,o=t.name;a.goodsInput[o]=n,a.setState({curGoods:a.goodsInput})},a.submitGoods=function(){a.setState({loading:!0}),J("/modify-goods",{method:"post",body:JSON.stringify(a.state.dataList)}).then((function(e){a.setState({loading:!1}),0===e.code?(p.a.success("\u63d0\u4ea4\u4fee\u6539\u6210\u529f"),a.props.onChange()):p.a.error("\u4fee\u6539\u5931\u8d25")}))},a}return Object(y.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this.setState({dataList:this.props.data})}},{key:"render",value:function(){var e=this;return o.a.createElement(o.a.Fragment,null,o.a.createElement("br",null),o.a.createElement(x.a.Group,null,o.a.createElement(x.a,{onClick:function(){e.goodsInput={name:"",desc:"",img:"",price:10},e.setState({visible:!0,curGoods:e.goodsInput,isModify:!1})}},"\u6dfb\u52a0\u5546\u54c1"),o.a.createElement(x.a,{loading:this.state.loading,onClick:this.submitGoods},"\u63d0\u4ea4\u4fee\u6539")),o.a.createElement("br",null),o.a.createElement(Y,{dataSource:this.state.dataList,buttonText:"\u4fee\u6539\u5546\u54c1",descLength:15,onClick:function(t){e.goodsInput=Object.assign({},t),e.setState({visible:!0,curGoods:e.goodsInput,isModify:!0})}}),o.a.createElement(ce,{title:"\u5546\u54c1\u4fe1\u606f",visible:this.state.visible,onOk:this.handleOk,onCancel:this.handleCancel,goods:this.state.curGoods,onChange:this.handleInputChange,footer:this.state.isModify?[o.a.createElement(x.a,{key:"cancel",onClick:this.handleCancel},"\u53d6\u6d88"),o.a.createElement(x.a,{key:"delete",type:"danger",onClick:this.removeGoods},"\u5220\u9664"),o.a.createElement(x.a,{key:"modify",type:"primary",onClick:this.modifyGoods},"\u4fee\u6539")]:[o.a.createElement(x.a,{key:"cancel",onClick:this.handleCancel},"\u53d6\u6d88"),o.a.createElement(x.a,{key:"add",type:"primary",onClick:this.addGoods},"\u6dfb\u52a0")]}))}}]),t}(n.Component),de=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(g.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(o)))).state={shopData:null,modifyStatus:"main",loaded:!1},a._isMounted=!1,a.reload=function(){J("/shop-data",{method:"post"}).then((function(e){a._isMounted&&a.setState({shopData:e.obj,loaded:!0})}))},a}return Object(y.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this._isMounted=!0,this.reload()}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"render",value:function(){var e=this,t=this.state,a=t.modifyStatus,n=t.shopData,r=t.loaded;return o.a.createElement(E.a,{style:{padding:"0 0 24px 0",background:"#fff",marginTop:"46px"}},o.a.createElement(ee.a,{style:{border:"1px solid rgb(235, 237, 240)"},onBack:function(){return e.setState({modifyStatus:"main"})},backIcon:"main"===a?o.a.createElement(N.a,{type:"home",theme:"twoTone"}):o.a.createElement(N.a,{type:"arrow-left"}),title:"main"===a?"\u7ba1\u7406\u9762\u677f":"good"===a?"\u5546\u54c1\u7ba1\u7406":"shop"===a?"\u5e97\u94fa\u4fe1\u606f":"order"===a?"\u8ba2\u5355\u67e5\u8be2":"\u672a\u77e5\u9875\u9762"}),o.a.createElement(ie,{style:{padding:"0 24px",minHeight:280}},"main"===a?o.a.createElement(o.a.Fragment,null,o.a.createElement("br",null),o.a.createElement(x.a.Group,null,r?o.a.createElement(x.a,{onClick:function(){e.setState({modifyStatus:"shop"})}},"\u4fee\u6539\u5e97\u94fa\u4fe1\u606f"):null,n?o.a.createElement(o.a.Fragment,null,o.a.createElement(x.a,{onClick:function(){e.setState({modifyStatus:"good"})}},"\u4fee\u6539\u5546\u54c1\u4fe1\u606f"),o.a.createElement(x.a,{onClick:function(){e.setState({modifyStatus:"order"})}},"\u4e70\u5bb6\u5df2\u652f\u4ed8\u8ba2\u5355\u67e5\u8be2")):null)):"shop"===a?o.a.createElement(le,{data:n||{name:"",desc:"",logo:""},onChange:function(){e.reload(),e.setState({modifyStatus:"main"})}}):"good"===a?o.a.createElement(ue,{data:n.goods,onChange:this.reload}):"order"===a?o.a.createElement(se,null):null))}}]),t}(n.Component),pe=(a(409),a(210)),me=E.a.Content,he=function(e){function t(){return Object(m.a)(this,t),Object(g.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){return o.a.createElement(E.a,{style:{padding:"24px 0",background:"#fff",marginTop:"46px"}},o.a.createElement(me,{style:{padding:"0 24px",minHeight:280}},o.a.createElement(pe.a,{status:"success",title:"\u8ba2\u5355\u652f\u4ed8\u6210\u529f",subTitle:"\u671f\u5f85\u60a8\u7684\u4e0b\u6b21\u8d2d\u4e70\uff0c\u7531\u4e8e\u65f6\u95f4\u5173\u7cfb\uff0c\u6682\u65f6\u53ea\u6709\u5546\u5bb6\u53ef\u4ee5\u67e5\u8be2\u5230\u8ba2\u5355",extra:[o.a.createElement(x.a,{type:"primary",key:"return",onClick:function(){return _.push("/")}},"\u8fd4\u56de\u4e3b\u9875")]})))}}]),t}(n.Component),ge=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(g.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(o)))).state={user:{},modifying:!1,loading:!0},a.input=a.props.user||{nickname:"",desc:"",avatar:""},a.handleInputChange=function(e){var t=e.target,n="checkbox"===t.type?t.checked:t.value,o=t.name;a.input[o]=n,a.setState({user:a.input})},a._isMounted=!1,a.onModify=function(){a.setState({modifying:!0});var e=a.input,t=e.nickname,n=e.desc,o=e.avatar,r=!0;(t.length>8||t.length<1)&&(r=!1,p.a.error("\u7528\u6237\u540d\u957f\u5ea6\u975e\u6cd5")),(0===n.length||n.length>100)&&(r=!1,p.a.error("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u63cf\u8ff0")),0===o.length&&(r=!1,p.a.error("\u8bf7\u4e0a\u4f20\u7528\u6237\u5934\u50cf")),r?J("/modify-user",{method:"post",body:JSON.stringify(a.input)}).then((function(e){a._isMounted&&(a.setState({modifying:!1}),0===e.code?(p.a.success(e.msg),_.push("/user")):p.a.error(e.msg))})):a.setState({modifying:!1})},a}return Object(y.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,J("/user",{method:"post"}).then((function(t){0===t.code&&(e.input=t.obj,e.setState({user:t.obj,loading:!1}))}))}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"render",value:function(){var e=this,t=this.state.user,a=t.nickname,n=t.desc,r=t.avatar;return o.a.createElement(k.a,{spinning:this.state.loading,loading:"Loading..."},o.a.createElement("br",null),o.a.createElement(L.a,{name:"nickname",placeholder:"\u6635\u79f0",defaultValue:a||"",value:a,onChange:this.handleInputChange}),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement(L.a,{name:"desc",placeholder:"\u81ea\u6211\u4ecb\u7ecd...",defaultValue:n,value:n,onChange:this.handleInputChange}),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement(ne,{className:"image-uploader",uploadText:"\u4e0a\u4f20\u5934\u50cf",name:"avatar",imageUrl:r,onUpload:function(t){e.input.avatar=t.obj,e.setState({avatar:t.obj})},style:{width:"126px",height:"126px"}}),o.a.createElement(x.a,{type:"primary",block:!0,loading:this.state.modifying,onClick:this.onModify},"\u4fdd\u5b58\u7528\u6237\u4fe1\u606f"))}}]),t}(n.Component),fe=E.a.Header,ye=E.a.Footer,be=E.a.Content,Ee=b.a.Title,ve=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(g.a)(this,Object(f.a)(t).call(this,e))).updateData=function(e){a.setState(e)},a.onRouteChanged=function(){a.setState({location:a.getCurSelectedMenu()}),localStorage.getItem("token")?(a.setState({isLogged:!0,loadingUser:!0}),J("/user",{method:"post"}).then((function(e){0===e.code?a.setState({isLogged:!0,user:e.obj,loadingUser:!1}):-128===e.code?a.setState({isLogged:!1,loadingUser:!1}):(p.a.warn("\u767b\u5f55\u4fe1\u606f\u5931\u6548"),A())})).catch((function(e){return console.log(e)}))):a.setState({isLogged:!1,loadingUser:!1})},a.pathMenutMap={"/manage":[/\/manage/g],"/":[/\/*/]},a.getCurSelectedMenu=function(){for(var e=0,t=Object.keys(a.pathMenutMap);e<t.length;e++){var n=t[e],o=!0,r=!1,i=void 0;try{for(var l,c=a.pathMenutMap[n][Symbol.iterator]();!(o=(l=c.next()).done);o=!0){if(l.value.test(a.props.location.pathname))return n}}catch(s){r=!0,i=s}finally{try{o||null==c.return||c.return()}finally{if(r)throw i}}}},a.state={isLogged:!1,loadingUser:!1,user:{nickname:"\u672a\u767b\u5f55",account:"0",avatar:"",desc:"",seller:!1},location:"/"},a}return Object(y.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this.onRouteChanged(this.props.location)}},{key:"componentDidUpdate",value:function(e){this.props.location!==e.location&&this.onRouteChanged(this.props.location)}},{key:"render",value:function(){var e=this.state.user,t=this.state.isLogged?"".concat(e.nickname," ").concat(e.seller?"\u5546\u5bb6":"\u4e70\u5bb6"):"\u5c1a\u672a\u767b\u5f55";return o.a.createElement(E.a,{id:"app-layout"},o.a.createElement(fe,{className:"header",style:{backgroundColor:"#fff"}},o.a.createElement(l.a,{type:"flex",align:"middle"},o.a.createElement(u.a,{span:20},o.a.createElement(Ee,{level:4,className:"logo"},"\u4e11\u56e2"),o.a.createElement(d.a,{theme:"light",mode:"horizontal",selectedKeys:[this.state.location],style:{lineHeight:"64px"}},o.a.createElement(d.a.Item,{key:"/"},o.a.createElement(j.a,{to:"/"},"\u5546\u5e97")),this.state.user.seller?o.a.createElement(d.a.Item,{key:"/manage"},o.a.createElement(j.a,{to:"/manage"},"\u7ba1\u7406")):null)),o.a.createElement(u.a,{span:4},o.a.createElement(l.a,{type:"flex",justify:"end",align:"middle"},o.a.createElement(c.a,{content:t,title:"\u7528\u6237\u4fe1\u606f",placement:"bottomLeft"},o.a.createElement(j.a,{to:this.state.loadingUser?"/":this.state.isLogged?"/user":"/login"},o.a.createElement(s.a,{icon:"user",size:"large",src:this.state.user.avatar,className:"avatar"}))))))),o.a.createElement(be,{style:{padding:"0 100px"}},o.a.createElement(v.c,null,o.a.createElement(v.a,{exact:!0,path:"/"},o.a.createElement(w,null)),o.a.createElement(v.a,{path:"/login"},o.a.createElement(V,null)),o.a.createElement(v.a,{path:"/user"},o.a.createElement(ge,{user:this.state.user})),o.a.createElement(v.a,{path:"/shop/:id",component:Z}),o.a.createElement(v.a,{path:"/manage",component:de}),o.a.createElement(v.a,{path:"/success",component:he}),o.a.createElement(v.a,{component:I}))),o.a.createElement(ye,{style:{textAlign:"center"}},"Web Course Design \xa92019 Created by Grapedge"))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement((function(){var e=Object(v.f)(ve);return o.a.createElement(v.b,{className:"App",history:_},o.a.createElement(e,null))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[214,1,2]]]);
//# sourceMappingURL=main.6ae1fb32.chunk.js.map